fixed issue 535 with the following code:
code